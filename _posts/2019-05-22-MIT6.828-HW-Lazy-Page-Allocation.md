---
layout: post
title: "MIT6.828 操作系统 HW:Lazy Page Allocation"
comments: true
description: "MIT6.828 操作系统 HW:Lazy Page Allocation"
keywords: "OS, assembly, c"
---

## Part One: Eliminate allocation from sbrk()

对于目前的 xv6 来说，调用 sbrk() 函数时会分配物理页和添加相应的 PTE 映射，这样我们就获得了更多的虚拟地址地址空间。可有时候分配来的空间并不会立即使用，甚至是不使用，这就造成了资源浪费。

为了避免这种情况，节省宝贵的系统资源，于是就有了 lazy allocation 的概念，要想实现 lazy allocation，就要求我们在调用 sbrk() 的时候不去真正的分配物理空间和建立 PTE 映射，只有在真正使用到相应的虚拟地址的时候才去分配。 

## Part Two: Lazy allocation