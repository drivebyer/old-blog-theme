---
layout: post
title: "xv6: 文件系统(二)"
comments: true
description: "xv6: 文件系统(二)"
keywords: "OS, xv6, c, file system"
---

&nbsp;

## 一、介绍

___

这篇文章纪录下我学习 xv6 文件系统（以后简称xv6fs）的过程。

xv6fs 算是整个 xv6 源码中的重头戏，整个文件系统很抽象，对于我这种 Unix 小白，头一次阅读这种代码十分的懵。经过反复阅读，终于领悟到了一点其中的奥妙。

下面是 xv6fs 逻辑上的分层图：

```
+------------------+
|  File Descriptor |
+------------------+
|     Pathname     |
+------------------+
|     Directory    |
+------------------+
|      Inode       |
+------------------+
|     Logging      |
+------------------+
|   Buffer Cache   |
+------------------+
|       Disk       |
+------------------+
```

下面从下向上一次介绍。

&nbsp;

## 二、Disk

___

on-disk datastruct








xv6文件系统由inode组成，每个inode是单个未命名的文件

UNIX file systems assign one inode to each file in the file system,a file's inode holds critical meta-data about the file such as its stat attributes and pointers to its data blocks.

Be wary of the distinction between the two terms: sector size is a property of the disk hardware, whereas block size is an aspect of the operating system using the disk. A file system's block size must be a multiple of the sector size of the underlying disk.

File systems typically reserve certain disk blocks at "easy-to-find" locations on the disk (such as the very start or the very end) to hold meta-data describing properties of the file system as a whole, such as the block size, disk size, any meta-data required to find the root directory, the time the file system was last mounted, the time the file system was last checked for errors, and so on. These special blocks are called superblocks.